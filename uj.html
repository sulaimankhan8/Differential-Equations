<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taylor Series and Differential Equation Solver</title>
</head>
<body>
    <h1>Taylor Series and Differential Equation Solver</h1>
    
    <label for="calcType">Calculation Type: </label>
    <select id="calcType" onchange="toggleInterface()">
        <option value="taylor">Taylor Series</option>
        <option value="differential">Differential Equation</option>
    </select><br><br>
    
    <div id="taylorInterface">
        <h2>Taylor Series Calculator</h2>
        <label for="function">Enter f(x): </label>
        <input type="text" id="function" placeholder="e.g. x*x"><br><br>
        
        <label for="x0">x0: </label>
        <input type="number" id="x0_taylor" step="any"><br><br>
        
        <label for="x">x: </label>
        <input type="number" id="x_taylor" step="any"><br><br>
        
        <label for="order">Order: </label>
        <input type="number" id="order_taylor"><br><br>
        
        <button onclick="calculateTaylor()">Calculate Taylor Series</button>
    </div>
    
    <div id="differentialInterface" style="display: none;">
        <h2>Differential Equation Solver</h2>
        <label for="expression">Enter y': </label>
        <input type="text" id="expression" placeholder="e.g. x*x + y*y"><br><br>
        
        <label for="x0">x0: </label>
        <input type="number" id="x0_diff" step="any"><br><br>
        
        <label for="y0">y0: </label>
        <input type="number" id="y0_diff" step="any"><br><br>
        
        <label for="x">x: </label>
        <input type="number" id="x_diff" step="any"><br><br>
        
        <label for="order">Order: </label>
        <input type="number" id="order_diff"><br><br>
        
        <button onclick="calculateDifferential()">Solve Differential Equation</button>
    </div>
    
    <h2>Result</h2>
    <p id="result"></p>
    <p id="polynomial"></p>
    
    
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/10.6.4/math.js"></script>
    <script>
        function factorial(n) {
            return n ? n * factorial(n - 1) : 1;
        }

        function nthDerivative(f, x0, y0, n, h = 1e-5) {
            if (n === 0) return y0;
            if (n === 1) return f(x0, y0);
            let prevValue = nthDerivative(f, x0, y0, n - 1, h);
            return (nthDerivative(f, x0 + h, y0 + h * prevValue, n - 1, h) - nthDerivative(f, x0 - h, y0 - h * prevValue, n - 1, h)) / (2 * h);
        }

        function taylorSeries(f, x0, y0, x, order) {
            let sum = y0;
            let polynomial = `${y0}`;
            for (let n = 1; n <= order; n++) {
                const derivative = nthDerivative(f, x0, y0, n);
                const term = (Math.pow(x - x0, n) / factorial(n)) * derivative;
                sum += term;
                polynomial += ` + (${derivative} * (x - ${x0})^${n} / ${factorial(n)})`;
            }
            return { sum, polynomial };
        }

        function calculate() {
            const expression = document.getElementById("expression").value;
            const x0 = parseFloat(document.getElementById("x0").value);
            const y0 = parseFloat(document.getElementById("y0").value);
            const x = parseFloat(document.getElementById("x").value);
            const order = parseInt(document.getElementById("order").value);
            const calcType = document.getElementById("calcType").value;
            
            const resultElement = document.getElementById("result");
            const polynomialElement = document.getElementById("polynomial");
            resultElement.textContent = "Calculating...";
            polynomialElement.textContent = "";

            try {
                if (calcType === "taylor" || calcType === "differential") {
                    const f = (x, y) => math.evaluate(expression, { x: x, y: y });
                    const { sum, polynomial } = taylorSeries(f, x0, y0, x, order);
                    resultElement.textContent = `Taylor Series approximation at x = ${x} is ${sum}`;
                    polynomialElement.textContent = `Polynomial: ${polynomial}`;
                }
            } catch (error) {
                resultElement.textContent = `Error: ${error.message}`;
            }
        }
    </script>
</body>
</html>
